

Διαμαρτύρεται χρήστης ότι έχει πρόβλημα να συνδεθεί στο δωμάτιο για το οποίο έχει λάβει πρόσκληση. Τί μπορώ να ελέγξω;
======================================================================================================================

Το πρώτο σημείο στο οποίο παραπέμπουμε το χρήστη είναι η [σελίδα Βοήθειας](https://webconf.grnet.gr/help) του ιστοχώρου.
Στη συνέχεια τον παροτρύνουμε να χρησιμοποιήσει το εργαλείο [Έλεγχος Σύνδεσης](http://webconf-bbb3.grnet.gr/check/) και να μας στείλει τα αποτελέσματα του ελέγχου πατώντας στο κουμπί `mail`. Βάσει των αποτελεσμάτων κρίνουμε αν το πρόβλημα είναι δικτυακό (ping delay, εύρος ζώνης), θέμα browser (αποφεύγουμε IE, προτείνουμε FF / Chrome), θέμα flash player ή θέμα java (απενεργοποιημένη σε FF / Chrome).


Διαμαρτύρεται χρήστης ότι ενώ είναι συνδεδεμένος, έχει διακοπές ή θόρυβο στον ήχο. Τί να ελέγξω;
==================================================================================================


Ρωτάμε το χρήστη ποιο browsers χρησιμοποιεί. Αν είναι IE (και άρα Flash για τον ήχο) τον παροτρύνουμε να χρησιμοποιήσει FF / Chrome για WebRTC ήχο.

Ρωτάμε το χρήστη να μας πει το φόρτου της μηχανής του (Ctrl+Shift+Esc, CPU Usage). Αν είναι υψηλός  του λέμε να κλείσει όλες τις άλλες εφαρμογές ώστε να χαμηλώσει ο φόρτος.

Ρωτάμε το χρήστη αν είναι συνδεδεμένες ενσύρματα ή ασύρματα, προτείνουμε ενσύρματα και αν είναι συνδεδεμένος ασύρματα  ελέγχουμε, μέσω της αντίστοιχης εφαρμογής του λειτουργικού συστήματός του, την ποιότητα της σύνδεσης και τον ρωτάμε πόσοι ακόμα είναι συνδεδεμένοι στο ασύρματο δίκτυό του και τί χρήση κάνουν. Ανάλογα των απαντήσεων προτείνουμε λύσεις όπως περιορισμού των συνδεδεμένων υπολοίπων χρηστών / συσκευών και περιορισμού της χρήσης του δικτύου από τους υπόλοιπους συνδεδεμένους χρήστες.


Πώς να ελέγξω πόσοι χρήστες συμμετέχουν σε ένα δωμάτιο; Πόσοι είναι συνδεδεμένοι αυτή τη στιγμή; Πώς θα δω στα logs αν προσπάθησαν;
===================================================================================================================================

Στο μενού διαχειριστή του portal, επιλέγοντας ζωντανά δωμάτια και πατώντας το εικονίδιο "Δείτε τους συνδεμένους χρήστες" εμφανίζονται τα ονόματα, ο ρόλος και σύνολο τρεχόντων συμμετεχόντων. Μπορούμε να ελέγξουμε την επιτυχία ή αποτυχία σύνδεσης ενός συμμετέχοντα κάνοντας σύνδεση στη κονσόλα του bbb server που λαμβάνει χώρα το δωμάτιο (εμφανίζεται στο portal για τους διαχειριστές στο πεδίο "Τελευταίος server") και ελέγχοντας το αρχείο `/var/log/bigbluebutton/bbb-web.log`.


Υπάρχει διαπιστωμένο πρόβλημα σε συγκεκριμένο δωμάτιο τηλεδιάσκεψης. Πώς δίνω οδηγίες για μεταφορά του σε νέο bbb server node;
==============================================================================================================================

Ενημερώνω τους χρήστες να αποσυνδεθούν από το δωμάτιο και να περιμένουν να κλείσει, δηλαδή να μην εμφανίζεται η ένδειξη "Σε εξέλιξη!". Αφαιρούμε το bbb server node από τη συστοιχία και ο επόμενος χρήστης που θα συνδεθεί στο δωμάτιο θα βρίσκεται πλέον σε νέο bbb server node.


Συντονιστής δωματίου δεν μπορεί να βρει video που πιστεύει ότι έπρεπε να έχει καταγραφεί. Πώς ελέγχω όλα τα bbb server nodes για την ύπαρξή του;
================================================================================================================================================

Από τη βάση, στον πίνακα rooms βρίσκουμε το BigBlueButton meeting id του δωματίου (πεδίο `bbb_meeting_id`) και από τον πίνακα meetings βρίσκουμε σε ποιόν bbb server node έλαβε χώρα το meeting τη χρονική στιγμή που μας έχει αναφέρει ο χρήστης. Στη συνέχεια συνδεόμαστε στον bbb server node που εντοπίσαμε και από το output της εντολής `bbb-record --list` ελέγχοντας το πεδίο External `MeetingID`, που θα πρέπει να ισούται με το `bbb_meeting_id` του δωματίου, και την ώρα της καταγραφής κρατάμε αντίστοιχο το Internal MeetingID. Έπειτα με αυτό το ID ελέγχουμε τα log αρχεία για τα δύο πρώτα στάδια της επεξεργασίας της καταγραφής (archive και sanity), που λαμβάνουν χώρα στον bbb server node, για σφάλματα. 

Τα αρχεία είναι:

  - `/var/log/bigbluebutton/archive-[Internal MeetingID].log` και
  - `/var/log/bigbluebutton/sanity.log`

Αν τα δύο αυτά στάδια έχουν ολοκληρωθεί με επιτυχία συνδεόμαστε στο αντίστοιχο transocoding server του ζευγαριού για να ελέγξουμε για σφάλματα στα δύο επόμενα στάδια της επεξεργασίας της καταγραφής (process και publish). Τα αρχεία που σχετίζονται είναι τα:

  - `/var/log/bigbluebutton/presentation/process-[Internal MeetingID].log` και
  - `/var/log/bigbluebutton/presentation/process-[Internal MeetingID].log`

Τα logs για το post publish στάδιο της επεξεργασίας της καταγραφής, δηλαδή της παραγωγής του download αρχείου, βρίσκονται στον transcoding server στη διαδρομή `/var/log/bigbluebutton/download/[Internal MeetingID].log`.

Ενώ οι καταγραφές του daemon service που εκτελεί το κάθε στάδιο βρίσκονται και στους δύο server στη διαδρομή `/var/log/bigbluebutton/bbb-rap-worker.log`.

Πώς ελέγχω ότι όλα τα ζευγάρια server nodes είναι σε καλή λειτουργία;
=====================================================================

Διατίθεται εργαλείο αυτό-ελέγχου του BigBlueButton από την κονσόλα με χρήση της εντολής `bbb-conf --check` ως χρήστης root.
Όσον αφορά τους transcoding server θα πρέπει να ελεγχθεί ότι το service monit (`/var/log/monit.log`) εκτελεί με επιτυχία το script επεξεργασίας των καταγραφών (`/usr/local/bigbluebutton/core/scripts/rap-worker.rb`) και ότι στο αρχείο καταγραφής αυτού `/var/log/bigbluebutton/rap-worker.log` δεν υπάρχουν σφάλματα.

Πώς βγάζω ένα ζεύγος server nodes εκτός λειτουργίας; Είτε για συντήρηση είτε γιατί διαπιστώθηκε πρόβλημα στη λειτουργία του.
============================================================================================================================

Από τη βάση δεδομένων του συστήματος, αλλάγω την τιμή online σε μηδέν (`0`) στον πίνακα bbb-servers για το ζεύγος που επιθυμώ να θέσω offline (εκτός λειτουργίας). Εφόσον ολοκληρωθούν οι εργασίες συντήρησης το θέτω και πάλι εντός λειτουργίας (online) αλλάζοντας τη τιμή σε μονάδα (`1`). 


Πότε αποφασίζω να προσθέσω ένα νέο ζεύγος server nodes εντός λειτουργίας και ποιά είναι η διαδικασία που πρέπει να ακολουθήσω;
==============================================================================================================================

Όταν και εφόσον παρατηρήσω ως διαχειριστής ότι στην υφιστάμενη υποδομή ο αριθμός των ταυτόχρονων τηλεδιασκέψεων είναι 4πλάσιος ή και μεγαλύτερος του αριθμού των BigBlueButton εξυπηρετητών. Έτσι, π.χ. για μία υποδομή που απαρτίζεται από συνολικά 4 BigBlueButton κόμβους θα πρέπει να αποφασίσω ότι χρειάζεται να προσθέσω νέο ζεύγος BigBlueButton & Trasncoding κόμβων εφόσον παρατηρώ ότι σε καθημερινή βάση πραγματοποιούνται περισσότερες από 16 τηλεδιασκέψεις ταυτόχρονα. 

Θα χρειαστεί πριν από όλα να αιτηθώ την παροχή 2 νέων εικονικών μηχανών (VM) στην υπηρεσία ViMa της ΕΔΕΤ. Τα προτεινόμενα specs είναι τα εξής:

BigBlueButton host:

  - CPUs: 4
  - Memory: 4GB
  - Disk: 50GB
  - OS: Ubuntu LTS
  - Όνομα: webconf-bbb`X`.grnet.gr, όπου `Χ` είναι ο επόμενος διαθέσιμος αύξοντας αριθμός (π.χ. `5`)

Transcoding host:

  - CPUs: 2
  - Memory: 2GB
  - Disk: 5GB
  - OS: Ubuntu LTS
  - Όνομα: webconf-trans`X`.grnet.gr, όπου `Χ` είναι ο επόμενος διαθέσιμος αύξοντας αριθμός (π.χ. `5`)

κατά την υποβολή της αίτησης προς τους διαχειριστές της υπηρεσίας ViMa της ΕΔΕΤ προσθέτουμε το εξής σχόλιο:

```
Θα επιθυμούσαμε το νέο VM να καταχωρηθεί σε public DNS και να έχει δυνατότητα σύνδεσης στο vlan318.
```

έτσι ώστε να υπάρχει η δυνατότητα απόδοσης εσωτερικών διευθύνσεων IP.

Εφόσον μας έχουνε παραχωρηθεί τα νέα VMs θα χρειαστεί να προστεθούν στο αρχείο inventory μέσα στο Ansible . Παράλληλα θα πρέπει να ορίσουμε τις μεταβλητές storage_path, internal_ip και  my_pair_bbb κατάλληλα. Έτσι, εάν έχουμε αιτηθεί για ένα νέο ζεύγος κόμβων με ονόματα webconf-bbb5.grnet.gr και webconf-trans5.grnet.gr θα πρέπει αυτά να καταχωρηθούν αντίστοιχα κάτω από τα groups bigbluebutton και transcoding ως εξής:

```
[bigbluebutton]
…
webconf-bbb5.grnet.gr storage_path=5 internal_ip=172.16.0.Y #(όπου 0<Υ<255)

[transcoding]
…
Webconf-trans5.grnet.gr storage_path=5 my_pair_bbb=webconf-bbb5.grnet.gr internal_ip=172.16.0.Z #(όπου 0<Z<255)

```

ΠΡΟΣΟΧΗ: Κατά την προσθήκη θα χρειαστεί να αποδοθεί σε κάθε νέο VM και μία εσωτερική IP (μέσω της μεταβλητής internal_ip), οπότε απαιτείται προσοχή ώστε να μην ανατεθεί σε κάποιον host IP που χρησιμοποιείται ήδη από άλλο VM της υποδομής.


Έπειτα τα βήματα για τη διαμόρφωση του νέου ζεύγους είναι τα εξής:

1) Προσθήκη ssh κλειδιών διαχειριστών:

```
$ ansible-playbook -v bootstrap.yml
```

2) Έλεγχος ότι τα νέα VMs έχουν ενταχθεί σωστά στο Ansible:

```
$ ansible -m ping -s bbb
```

3) Διαμόρφωση του νέου ζεύγους:

```
$ ansible-playbook -f 1 -v deploy.yml
```






